syntax = "proto3";

package ose.datos.analisis;

import "google/protobuf/timestamp.proto";
import "google/protobuf/struct.proto";
import "google/protobuf/any.proto";

message IAnomalia {
  optional string _id = 1;
  string idCliente = 2;
  optional string idDivision = 3;
  optional string idJefatura = 4;
  optional string idDistrito = 5;
  optional string idPuntoMedicion = 6;
  string tipo = 7;
  string severidad = 8;
  string estado = 9;
  string momentoDeteccion = 10;
  string descripcion = 11;
  optional string metodoDeteccion = 12;
  optional ICoordenadas ubicacionEstimada = 13;
  optional string referenciaUbicacion = 14;
  optional double perdidaEstimada = 15;
  optional double poblacionAfectada = 16;
  optional string usuarioAsignado = 17;
  optional string fechaAsignacion = 18;
  optional string fechaResolucion = 19;
  optional string notasResolucion = 20;
  optional string historialAcciones = 21;
  optional string fechaCreacion = 22;
  optional google.protobuf.Any cliente = 23;
  optional google.protobuf.Any division = 24;
  optional google.protobuf.Any jefatura = 25;
  optional google.protobuf.Any distrito = 26;
  optional google.protobuf.Any puntoMedicion = 27;
}

message ICreateAnomalia {
  string idCliente = 1;
  string tipo = 2;
  string severidad = 3;
  string estado = 4;
  string momentoDeteccion = 5;
  string descripcion = 6;
  optional string idDivision = 7;
  optional string idJefatura = 8;
  optional string idDistrito = 9;
  optional string idPuntoMedicion = 10;
  optional string metodoDeteccion = 11;
  optional ICoordenadas ubicacionEstimada = 12;
  optional string referenciaUbicacion = 13;
  optional double perdidaEstimada = 14;
  optional double poblacionAfectada = 15;
  optional string usuarioAsignado = 16;
  optional string fechaAsignacion = 17;
  optional string fechaResolucion = 18;
  optional string notasResolucion = 19;
  optional string historialAcciones = 20;
}

message IUpdateAnomalia {
  optional string idCliente = 1;
  optional string idDivision = 2;
  optional string idJefatura = 3;
  optional string idDistrito = 4;
  optional string idPuntoMedicion = 5;
  optional string tipo = 6;
  optional string severidad = 7;
  optional string estado = 8;
  optional string momentoDeteccion = 9;
  optional string descripcion = 10;
  optional string metodoDeteccion = 11;
  optional ICoordenadas ubicacionEstimada = 12;
  optional string referenciaUbicacion = 13;
  optional double perdidaEstimada = 14;
  optional double poblacionAfectada = 15;
  optional string usuarioAsignado = 16;
  optional string fechaAsignacion = 17;
  optional string fechaResolucion = 18;
  optional string notasResolucion = 19;
  optional string historialAcciones = 20;
}

message IBalanceHidrico {
  optional string _id = 1;
  string idCliente = 2;
  string idDistrito = 3;
  string periodo = 4;
  string fechaInicio = 5;
  string fechaFin = 6;
  double volumenEntrada = 7;
  double volumenSalida = 8;
  double consumoAutorizadoNoMedido = 9;
  double perdidasCalculadas = 10;
  double porcentajePerdidas = 11;
  double porcentajeEficiencia = 12;
  string estado = 13;
  string fechaCalculo = 14;
  optional string usuarioValidador = 15;
  optional string fechaValidacion = 16;
  optional string notas = 17;
  optional string detalles = 18;
  optional string fechaCreacion = 19;
  optional google.protobuf.Any cliente = 20;
  optional google.protobuf.Any distrito = 21;
}

message ICreateBalanceHidrico {
  string idCliente = 1;
  string idDistrito = 2;
  string periodo = 3;
  string fechaInicio = 4;
  string fechaFin = 5;
  double volumenEntrada = 6;
  double volumenSalida = 7;
  double consumoAutorizadoNoMedido = 8;
  double perdidasCalculadas = 9;
  double porcentajePerdidas = 10;
  double porcentajeEficiencia = 11;
  string estado = 12;
  string fechaCalculo = 13;
  optional string usuarioValidador = 14;
  optional string fechaValidacion = 15;
  optional string notas = 16;
  optional string detalles = 17;
}

message IUpdateBalanceHidrico {
  optional string idCliente = 1;
  optional string idDistrito = 2;
  optional string periodo = 3;
  optional string fechaInicio = 4;
  optional string fechaFin = 5;
  optional double volumenEntrada = 6;
  optional double volumenSalida = 7;
  optional double consumoAutorizadoNoMedido = 8;
  optional double perdidasCalculadas = 9;
  optional double porcentajePerdidas = 10;
  optional double porcentajeEficiencia = 11;
  optional string estado = 12;
  optional string fechaCalculo = 13;
  optional string usuarioValidador = 14;
  optional string fechaValidacion = 15;
  optional string notas = 16;
  optional string detalles = 17;
}

message ISerieTemporal {
  string idPuntoMedicion = 1;
  optional string tipoLectura = 2;
  string fechaInicio = 3;
  string fechaFin = 4;
  repeated google.protobuf.Any lecturas = 5;
  optional string estadisticas = 6;
  optional string generadoEn = 7;
  optional double duracionQuery = 8;
}

message IQuerySerieTemporal {
  string idPuntoMedicion = 1;
  optional string tipoLectura = 2;
  string fechaInicio = 3;
  string fechaFin = 4;
  optional bool incluirEstadisticas = 5;
  optional bool interpolarGaps = 6;
  optional string resolucion = 7;
}


service AnomaliaService {
  rpc Create(ICreateAnomalia) returns (IAnomalia);
  rpc Find(QueryRequest) returns (IAnomaliaList);
  rpc FindById(IdRequest) returns (IAnomalia);
  rpc Update(UpdateAnomaliaRequest) returns (IAnomalia);
  rpc Delete(IdRequest) returns (DeleteResponse);
}

message UpdateAnomaliaRequest {
  string id = 1;
  IUpdateAnomalia data = 2;
}

message IAnomaliaList {
  repeated IAnomalia items = 1;
  int32 total = 2;
}

service BalanceHidricoService {
  rpc Create(ICreateBalanceHidrico) returns (IBalanceHidrico);
  rpc Find(QueryRequest) returns (IBalanceHidricoList);
  rpc FindById(IdRequest) returns (IBalanceHidrico);
  rpc Update(UpdateBalanceHidricoRequest) returns (IBalanceHidrico);
  rpc Delete(IdRequest) returns (DeleteResponse);
}

message UpdateBalanceHidricoRequest {
  string id = 1;
  IUpdateBalanceHidrico data = 2;
}

message IBalanceHidricoList {
  repeated IBalanceHidrico items = 1;
  int32 total = 2;
}

message QueryRequest {
  optional string filter = 1;
  optional int32 limit = 2;
  optional int32 skip = 3;
}

message IdRequest {
  string id = 1;
}

message DeleteResponse {
  bool success = 1;
  string message = 2;
}
